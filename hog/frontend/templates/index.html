{% extends "_base.html" %}
{% load static %}

{% block content %}

<h1>Welcome to Hedgehog Republic!</h1>

<p>The hedgehog republic is the idea that by joining gardens together and closely monitoring the hedgehogs we will be able to maintain and grow the populations.</p>
<p>Explore the latest monitoring info by clicking on a pin below:</p>
<h3>Our boxes</h3>

<div class="row">
<div class="col">
  <div id="map"></div>
</div>
</div>
<hr>
<div class="row">
  <div class="col">
    <h3>Recent videos</h3>
  </div>
</div>

<div class="row">
  {% for group in videos %}

  <div class="col-lg-6">
    <div class="card-wall">
      <div id="card-wall">
          {% include '_card.html' %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoic2ViYmFjb24iLCJhIjoiY2ltdGYwZGJkMDA2a3Z3bTFucjgyZnlvdCJ9.hplRw1YZqso0DZNteF9S-g';
var bounds = [[-2.21541, 51.74051], [-2.20105, 51.74452]];
var map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/streets-v9',
  bounds: bounds,
  fitBoundsOptions: { padding: 50 },
  minZoom: 11
});
map.addControl(new mapboxgl.NavigationControl());
$.getJSON("/api/locations/?format=json", function(data) {
  data.results.forEach(function(box) {
    var coords = box.coords.coordinates;
    new mapboxgl.Marker()
      .setLngLat([coords[0], coords[1]])
      .setPopup(new mapboxgl.Popup({ offset: 25 })
      .setHTML("<strong><a href='/location/" + box.code + "'>"  + box.name + "</a></strong>"))
      .addTo(map);
  });
});
</script>

{% endblock %}
